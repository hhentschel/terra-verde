<!-- Template: {{ _self }}.twig -->
{% set customer = craft.commerce.customers.customer %}
{% set primaryBillingAddress = customer.getPrimaryBillingAddress() %}
{% set primaryShippingAddress = customer.getPrimaryShippingAddress() %}

<div class="js-address-fieldset {{ class }}">
  {% if addresses and currentUser %}

    <div class="">
      {% for address in addresses %}

        <div class="shippingadress-container">
          <div class="radio-container">
            {# <label class="radio-container__label address-select js-address-select" data-address-id="{{ address.id }}">
              <div class="radio-container__box">
                <div class="radio-container__radio radio-container__box js-radio">
                  <input type="checkbox" name="{{ name }}Id"
                        data-model-name="{{ name }}"
                      {% if attribute(cart,name~'Id') == address.id %}checked="checked"{% endif %} value="{{ address.id }}"/>
                      {% include 'shop/_includes/addresses/address' %}
                </div>
              </div>
            </label> #}

            <div class="radio-container__box">
              <div class="radio-container__radio radio-container__box js-radio">
                <h2 class="heading heading--2 heading--no-margin-top">
                  {% if
                    primaryBillingAddress
                    and primaryBillingAddress.id == address.id %}
                    Rechnungsadresse
                  {% endif %}
                  {% if
                    primaryShippingAddress
                    and primaryShippingAddress.id == address.id %}
                    Versandadresse
                  {% endif %}
                  </h3>
                  {% include 'shop/_includes/addresses/address' %}
              </div>
            </div>
            <div>

            </div>

          </div>
          <div class="actions">
            <ul>
              <li>
                <a class="button button--secondary button--edit"
                   href="{{ url('shop/customer/addresses/edit?addressId='~ address.id ~'&redirect='~craft.app.request.fullPath) }}">Ã„ndern</a>
              </li>
            </ul>
          </div>
        </div>

      {% endfor %}


    </div>
  {% endif %}

  <div class="address-select js-address-select js-address-select-new" data-model-name="{{ name }}">
    {% if attribute(cart, name~'Id') %}
      {% set addressHasErrors = attribute(cart, name).hasErrors() %}
    {% else %}
      {% set addressHasErrors = false %}
    {% endif %}


    {# If we have no addresses expand the 'New Address" fields by default it to being checked.
                   If we have errors on the address also check and expand. #}
    {# {% if currentUser %}
            <div class="js-radio">
                <label>
                  <input type="radio" name="{{ name }}Id"
                         {% if not addresses|length or addressHasErrors %}checked="checked"{% endif %} value=""/>
                  <strong>{{ "Neue" }} {{ title }}</strong>
                </label>
            </div>
        {% endif %} #}

    <div class="js-body {% if currentUser %}hidden{% endif %}">
      {% if addressHasErrors %}<span class="flash">{{ cart.getErrors(name)|join }}</span><br>{% endif %}
      {% include 'shop/_includes/addresses/form' with {
        'modelName': name,
        'address': attribute(cart, name)
      } %}
    </div>
  </div>

</div>
